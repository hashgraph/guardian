<div class="graph-tab" *ngIf="hasData">
    <div class="graph-layout">

        <div class="tree-container">
            <app-tree-graph
                (init)="initGraph($event)"
                (render)="onRender()"
                (select)="onSelect($event)"
            >
                <ng-template #nodeTemplate let-node="node">
                    <div
                        class="tree-node root-node"
                        [ngClass]="[
                            'selected-type-' + node.selected,
                            getNodeStatusClass(node)
                        ]"
                    >
                        <div class="node-header">
                            {{ node.data.title }}
                        </div>
                    </div>
                </ng-template>
            </app-tree-graph>
        </div>

        <div class="node-details" [attr.hidden-node]="!selectedItem">
            <div *ngIf="selectedItem as item" class="node-details-container">

                <div class="node-details-header">
                    <div class="node-details-title">
                        {{ selectedTitle }}
                    </div>
                    <div class="node-details-close" (click)="clearSelection()">
                        âœ•
                    </div>
                </div>

                <!-- TYPE -->
                <div class="node-details-section">
                    <div class="section-label">Type</div>
                    <div class="section-value">
                        {{ getItemType(item) }}
                    </div>
                </div>

                <!-- VALUE STATUS -->
                <div *ngIf="valueStatus" class="node-details-section">
                    <div class="section-label">Value status</div>
                    <div class="section-value">
                        {{ formatValueStatus(valueStatus) }}
                    </div>
                </div>

                <!-- FIELD VALUE TYPE -->
                <div *ngIf="valueKind" class="node-details-section">
                    <div class="section-label">Field value type</div>
                    <div class="section-value">
                        {{ formatValueKind(valueKind) }}
                    </div>
                </div>

                <!-- FORMULA / CONSTANT / TEXT -->
                <div *ngIf="mainValue" class="node-details-section">
                    <div class="section-label">
                        {{ mainValueLabel }}
                    </div>
                    <div class="section-value" *ngIf="getItemType(item) !== 'formula'">
                        {{ mainValue }}
                    </div>
                    <div class="section-value" *ngIf="getItemType(item) === 'formula'">
                        <math-live
                            [value]="mainValue"
                            [readonly]="true">
                        </math-live>
                    </div>
                </div>

                <!-- FIELD NAME IN DOCUMENT -->
                <div *ngIf="fieldName" class="node-details-section">
                    <div class="section-label">Field name in document</div>
                    <div class="section-value">
                        {{ fieldName }}
                    </div>
                </div>

                <!-- VALUE FROM VC -->
                <div *ngIf="fieldValue !== null" class="node-details-section">
                    <div class="section-label">Field value in VC</div>
                    <div class="section-value">
                        {{ fieldValue }}
                    </div>
                </div>

                <!-- FIELD PATH -->
                <div *ngIf="fieldPath" class="node-details-section">
                    <div class="section-label">Field path</div>
                    <div class="section-value">
                        {{ fieldPath }}
                    </div>
                </div>

                <!-- DOCUMENT NAME -->
                <div *ngIf="nodeDocument" class="node-details-section">
                    <div class="section-label">Document (VC)</div>
                    <div class="section-value">
                        {{ nodeDocument }}
                    </div>
                </div>

                <!-- PARENT DOCUMENTS -->
                <div *ngIf="parentDocuments?.length" class="node-details-section">
                    <div class="section-label">Parent documents</div>
                    <ul class="section-list">
                        <li *ngFor="let doc of parentDocuments">
                            {{ doc }}
                        </li>
                    </ul>
                </div>

                <!-- DESCRIPTION -->
                <div *ngIf="getItemDescription(item)" class="node-details-section">
                    <div class="section-label">Description</div>
                    <div class="section-value">
                        {{ getItemDescription(item) }}
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>
