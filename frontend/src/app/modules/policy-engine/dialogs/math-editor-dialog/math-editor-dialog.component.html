<div class="dialog-header">
    <div class="header-container">
        <div class="header-text">Editor</div>
        <div *ngIf="block" class="header-item">{{block?.tag}}</div>
    </div>
    <div class="header-icon" (click)="onClose()">
        <svg-icon src="/assets/images/icons/close.svg" svgClass="icon-color-close"></svg-icon>
    </div>
</div>
<div class="dialog-body">
    <div *ngIf="loading" class="guardian-loading">
        <div class="guardian-loading-image"></div>
    </div>
    <div class="context">
        <div class="left-context">

        </div>
        <div #contextBody class="right-context dialog-keyboard">

            <div *ngIf="scope">


                <div class="formulas-container">
                    <div *ngFor="let formula of scope.formulas" class="formula-container">
                        <div class="formula-name">
                            <div class="guardian-input-container">
                                <input 
                                    [(ngModel)]="formula.functionNameText" 
                                    pInputText 
                                    type="text"
                                    placeholder="Name"
                                    (change)="formula.updateName()"/>
                            </div>
                        </div>
                        <div class="formula-eq">=</div>
                        <div class="formula-body">
                            <math-live 
                                [(value)]="formula.functionBodyText" 
                                [readonly]="false"
                                [keyboardContainer]="contextBodyRef"
                                (keyboard)="onKeyboard($event)"
                                (focus)="onKeyboardFocus($event)"
                                (change)="formula.update()"
                            ></math-live>
                        </div>
                        <div class="formula-del">
                            <button 
                                class="guardian-icon-button big" 
                                (click)="deleteFormula(formula)">
                                <svg-icon
                                    class="icon-btn svg-icon"
                                    src="/assets/images/icons/delete.svg"
                                    svgClass="icon-color-delete">
                                </svg-icon>
                            </button>
                        </div>
                    </div>

                    <button (click)="addFormula()" class="guardian-button guardian-button-secondary add-formula-btn">
                        <div class="guardian-button-icon">
                            <svg-icon class="icon-btn svg-icon-16" src="/assets/images/icons/16/add.svg"
                                svgClass="icon-color-primary">
                            </svg-icon>
                        </div>
                        <div class="guardian-button-label">Add Formula</div>
                    </button>
                </div>


            </div>





        </div>

    </div>
</div>
<div class="dialog-footer">
    <div class="action-buttons">
        <div class="dialog-button">
            <button
                (click)="onClose()"
                class="guardian-button guardian-button-secondary">Close</button>
        </div>
        <div *ngIf="test" class="dialog-button">
            <button
                (click)="onTest()"
                class="guardian-button guardian-button-primary">Test</button>
        </div>
        <div class="dialog-button">
            <button
                (click)="onSave()"
                class="guardian-button guardian-button-primary">Save</button>
        </div>
    </div>
</div>
