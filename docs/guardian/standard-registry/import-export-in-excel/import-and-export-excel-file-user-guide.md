# ðŸ’» Import and Export Excel file User Guide

The â€˜Import/Export schemas from/to Excelâ€™ UI menu options trigger the process of seamless transformation of schemas
written in Excel into valid Guardian JSON schemas, and vice versa. The content of such schema excel files must conform
to the format presented in the template accessible via the corresponding button on the 'Policy Schemasâ€™ page. The menu
options for actioning Import and Export are accessible via the â€˜Manage Policiesâ€™ and â€˜Policy Schemasâ€™ pages.

In Guardian schemas usually exist within a Policy, a Tool or embedded into another schema. To ease the process when a
schema or a set of schemas are imported, they get imported into a context of a policy. Users can create a new empty
policy for such purposes or use an existing policy. In the latter case all existing schemas in the policy are
preserved (and can be manually deleted later), new schemas are added together with the basic policy blocks scaffolding
which is inserted at the beginning of the policy flow.

When schemas are exported, they are packaged into a single Excel file formatted like the template mentioned above. It is
recommended to experiment with exporting your existing policies and reviewing the resulting excel files so you can
familiarize yourself with the format and the content.

## 1. Import

Use the corresponding menu option : **Import schemas from Excel** in the Manage Policies or Policy Schemas pages.

<figure><img src="../../../.gitbook/assets/0 (13).png" alt=""><figcaption></figcaption></figure>

Import section pops up where we need to upload .xlsx file:

<figure><img src="../../../.gitbook/assets/1 (15).png" alt=""><figcaption></figcaption></figure>

### 1.1 Errors

In case, when the importing engine was unable to parse the content of the given excel file then Guardian indicates the existence of the problem to the user, and gives an option to skip the invalid part to continue importing by clicking on **Skip & Import** button:

![](<../../../.gitbook/assets/2 (17).png>)

In cases, where the importing engine was not able to parse the content of a field then Guardian would specifically highlight this field in the schema after the import in red color rows:\


![](<../../../.gitbook/assets/3 (14).png>)

![](<../../../.gitbook/assets/4 (12).png>)

### 1.2 Blocks

Importing schemas into a Guardian policy will result in a number of new autogenerated blocks appearing in the beginning of the policy flow which â€˜holdâ€™ each imported schema and its tool or form as shown in the screenshot below.

![](<../../../.gitbook/assets/5 (15).png>)

### 1.3 Template

Guardian provides a basic downloadable Excel schema template which contains all possible types and structural elements supported by the system for importing. This template can be downloaded by clicking on the button highlighted in screenshot below:

![](<../../../.gitbook/assets/6 (14).png>)

<figure><img src="../../../.gitbook/assets/7 (14).png" alt=""><figcaption></figcaption></figure>

All schemas created for importing into Guardian must follow the design of the template containing the following elements:

* _**Schema name**_ â€“ unique schema name (also used in the name of the page and is limited to 30 characters)
* _**Description** (optional)_ â€“ schema description
* _**Schema Type**_ â€“ the value in this field influences the type of the signature and additional system fields
  * **Verifiable Credentials (VC)** â€“ linked to the policy and can be used in forms.
  * **Encrypted Verifiable Credential (EVC)** â€“ linked to the policy and can be used in forms. Unlike a simple VC it gets encrypted when saved into IPFS.
  * **Sub-Schema (None)** â€“ schemas without additional system fields which are suitable for embedded data.
* _**Tool**_ _(optional) â€“_ name of the Tool to which this schema belongs
* _**Tool Id**_ â€“ message id of the Tool to which this schema belongs (if relevant)

{% hint style="info" %}
**Note:** If the imported schema belongs to a Tool (not a Policy) - i.e. there is a Tool ID setting as per above - all extended information about the schema will not be processed during import. Since Tools are immutable and can only be referenced the only relevant information that would be used in the import is the Tool ID.
{% endhint %}

* Table listing each field which the schema contains.

{% hint style="info" %}
**Note:** The order of the columns in the spreadsheet is irrelevant.
{% endhint %}

* _**Required Field**_ - this field must be filled our (Yes/No)
* _**Field Type**_ â€“ type of the data matching that of Schema concepts in Guardian
  * Enum
  * Number
  * Integer
  * String
  * Pattern â€“ text field (String) which gets validated against the specified pattern
  * Boolean
  * Date
  * Time
  * DateTime
  * Duration
  * URL
  * URI
  * Email
  * Image
  * Help Text
  * GeoJSON
  * Prefix
  * Postfix
  * HederaAccount
  * Auto-Calculate
  * **Sub-schema name** â€“ the name of the embedded schema (or the name of the tag in the spreadsheet)
* _**Parameter**_ â€“ additional field for information relevant for some data types
  * Enum â€“ name of the enumeration (or the name of the tab in the spreadsheet) - list of possible options
  * Pattern â€“ regular expression
  * Help Text â€“ text style
  * Prefix â€“ symbol
  * Postfix â€“ symbol
* _**Visibility**_ â€“ determines the visibility of the field for user
  * No â€“ always hidden
  * EXACT({FieldName},{Value}) â€“ only shown when the condition is true
  * NOT(EXACT({FieldName},{Value})) â€“ only shown when the condition is not true
* _**Question**_ â€“ Description of the field. This is the text which users would see when filling out the form in Guardian.
* _**Allow Multiple Answers**_ â€“ Determines if the data is an array or a single item (Yes/No)
* _**Answer**_ â€“ example of the valid data

{% hint style="info" %}
**Note:** Currently only expression containing simple arithmetic operations are supported for **Auto-Calculate** in the _**Answer.**_ When specified it would result an the generation of the function template as shown on the example below.
{% endhint %}

![](<../../../.gitbook/assets/8 (15).png>)

## 2. Export

Use the corresponding menu option : **Export schemas to Excel** in the Manage Policies or Policy Schemas pages.

![](<../../../.gitbook/assets/9 (13).png>)

![](<../../../.gitbook/assets/10 (14).png>)
